{
    "abstractText": "Blockchain, as a decentralized and distributed public ledger technology in peer-to-peer network, has received considerable attention recently. It applies a linked block structure to verify and store data, and applies the trusted consensus mechanism to synchronize changes in data, which makes it possible to create a tamper-proof digital platform for storing and sharing data. It is believed that blockchain can be utilized in diverse Internet interactive systems (e.g., Internet of Things, supply chain systems, identity management, and so on). However, there are some privacy challenges that may hinder the applications of blockchain. The goal of this survey is to provide some insights into the privacy issues associated with blockchain. We analyze the privacy threats in blockchain and discuss existing cryptographic defense mechanisms, i.e., anonymity and transaction privacy preservation. Furthermore, we summarize some typical implementations of privacy preservation mechanisms in blockchain and explore future research challenges that still need to be addressed in order to preserve privacy when blockchain is used.",
    "authors": [
        {
            "affiliations": [],
            "name": "Qi Feng"
        },
        {
            "affiliations": [],
            "name": "Debiao He"
        },
        {
            "affiliations": [],
            "name": "Sherali Zeadally"
        },
        {
            "affiliations": [],
            "name": "Muhammad Khurram Khan"
        },
        {
            "affiliations": [],
            "name": "Neeraj Kumar"
        }
    ],
    "id": "SP:2b5d3f3bbc16763122a8a50c4b34c48ffbb727ab",
    "references": [
        {
            "authors": [
                "S.A. Abeyratne",
                "R.P. Monfared"
            ],
            "title": "Blockchain Ready Manufacturing Supply Chain",
            "year": 2016
        },
        {
            "authors": [
                "M. Ledger. Ali",
                "J.C. Nelson",
                "R. Shea",
                "M.J. Freedman"
            ],
            "title": "Blockstack: a global naming",
            "year": 2016
        },
        {
            "authors": [
                "S. Barber",
                "X. Boyen",
                "E. Shi",
                "E. Uzun"
            ],
            "title": "Bitter to betterhow to make bitcoin",
            "venue": "Data Security. Springer,",
            "year": 2012
        },
        {
            "authors": [
                "G. Bissias",
                "A.P. Ozisik",
                "B.N. Levine",
                "M. Liberatore"
            ],
            "title": "Sybil-resistant mixing for",
            "venue": "Privacy (SP),",
            "year": 2015
        },
        {
            "authors": [
                "M. Castro",
                "B Liskov"
            ],
            "title": "Practical byzantine fault tolerance",
            "venue": "In: OSDI,",
            "year": 1999
        },
        {
            "authors": [
                "M. Conoscenti",
                "A. Vetr\u00f2",
                "J.C. De Martin"
            ],
            "title": "Blockchain for the Internet of Things: a Systematic Literature Review",
            "year": 2016
        },
        {
            "authors": [
                "K. Delmolino",
                "M. Arnett",
                "A. Kosba",
                "A. Miller",
                "E. Shi"
            ],
            "title": "Step by step towards creating a safe smart contract: lessons and insights from a cryptocurrency lab",
            "venue": "In: International Conference on Financial Cryptography and Data Security",
            "year": 2016
        },
        {
            "authors": [
                "A. Dorri",
                "S.S. Kanhere",
                "R. Jurdak"
            ],
            "title": "Blockchain in Internet of Things: Challenges and Solutions. arxiv:1608.05187",
            "year": 2016
        },
        {
            "authors": [
                "A. Ebrahimi"
            ],
            "title": "Identity Management Service Using a Blockchain Providing Certifying Transactions between Devices,",
            "venue": "US Patent 9,722,790",
            "year": 2017
        },
        {
            "authors": [
                "S. Feld",
                "M. Sch\u00f6nfeld",
                "M. Werner"
            ],
            "title": "Analyzing the deployment of bitcoin\u2019s p2p network under an as-level perspective",
            "venue": "Proced. Comput. Sci",
            "year": 2014
        },
        {
            "authors": [
                "C. Fromknecht",
                "D. Velicanu",
                "S. Yakoubov"
            ],
            "title": "A decentralized public key infrastructure with identity retention",
            "venue": "IACR Cryptol. ePrint Arch",
            "year": 2014
        },
        {
            "authors": [
                "E. Fujisaki"
            ],
            "title": "Sub-linear size traceable ring signatures without random oracles",
            "venue": "In: CT-RSA,",
            "year": 2011
        },
        {
            "authors": [
                "E. Fujisaki",
                "K. Suzuki"
            ],
            "title": "Traceable ring signature",
            "venue": "Public Key Cryptography,",
            "year": 2007
        },
        {
            "authors": [
                "D. Genkin",
                "D. Papadopoulos",
                "C. Papamanthou"
            ],
            "title": "Privacy in decentralized cryptocurrencies",
            "venue": "Commun. ACM",
            "year": 2018
        },
        {
            "authors": [
                "M. Gill",
                "G. Taylor"
            ],
            "title": "Preventing money laundering or obstructing business? financial companies\u2019 perspectives on know your customerprocedures",
            "venue": "Br. J. Criminol",
            "year": 2004
        },
        {
            "authors": [
                "A. Greenberg"
            ],
            "title": "Dark Walletis about to Make Bitcoin Money Laundering Easier than Ever",
            "year": 2014
        },
        {
            "authors": [
                "Halim",
                "N.S.B.A",
                "M.A. Rahman",
                "S. Azad",
                "M.N. Kabir"
            ],
            "title": "Blockchain security hole: issues and solutions",
            "venue": "In: International Conference of Reliable Information and Communication Technology,",
            "year": 2017
        },
        {
            "authors": [
                "E. Heilman",
                "F. Baldimtsi",
                "S. Goldberg"
            ],
            "title": "Blindly signed contracts: anonymous on-blockchain and off-blockchain bitcoin transactions",
            "venue": "In: International Conference on Financial Cryptography and Data Security",
            "year": 2016
        },
        {
            "authors": [
                "E. Heilman",
                "L. Alshenibr",
                "F. Baldimtsi",
                "A. Scafuro",
                "S. Goldberg"
            ],
            "title": "Tumblebit: An untrusted bitcoin-compatible anonymous payment hub. In: Network and Distributed System Security Symposium",
            "year": 2017
        },
        {
            "authors": [
                "S. Huh",
                "S. Cho",
                "S. Kim"
            ],
            "title": "Managing iot devices using blockchain platform",
            "venue": "Advanced Communication Technology (ICACT),",
            "year": 2017
        },
        {
            "authors": [
                "H.M. Kim",
                "M. Laskowski"
            ],
            "title": "Towards an Ontology-driven Blockchain Design for Supply Chain Provenance",
            "year": 2016
        },
        {
            "authors": [
                "F. Knirsch",
                "A. Unterweger",
                "G. Eibl",
                "D. Engel"
            ],
            "title": "Pprivacy-preserving smart grid tariff decisions with blockchain-based smart contracts. Sustain",
            "venue": "Cloud Energy Serv",
            "year": 2017
        },
        {
            "authors": [
                "F. Knirsch",
                "A. Unterweger",
                "D. Engel"
            ],
            "title": "Privacy-preserving blockchain-based electric vehicle charging with dynamic tariff decisions",
            "venue": "Comput. Sci. Res. Dev",
            "year": 2018
        },
        {
            "authors": [
                "K. Korpela",
                "J. Hallikas",
                "T. Dahlberg"
            ],
            "title": "Digital supply chain transformation toward blockchain integration",
            "venue": "Proceedings of the 50th Hawaii International Conference on System Sciences",
            "year": 2017
        },
        {
            "authors": [
                "A. Kosba",
                "A. Miller",
                "E. Shi",
                "Z. Wen",
                "C. Papamanthou"
            ],
            "title": "Hawk: the blockchain model of cryptography and privacy-preserving smart contracts",
            "venue": "Security and Privacy (SP),",
            "year": 2016
        },
        {
            "authors": [
                "P. Koshy",
                "D. Koshy",
                "P. McDaniel"
            ],
            "title": "An analysis of anonymity in bitcoin using p2p network traffic",
            "venue": "In: International Conference on Financial Cryptography and Data Security",
            "year": 2014
        },
        {
            "authors": [
                "Kuan",
                "H.-H",
                "Chen",
                "R.-J"
            ],
            "title": "Denial of Service Resistance for Bitcoin Mixing Method Tumblebit",
            "year": 2017
        },
        {
            "authors": [
                "X. Li",
                "P. Jiang",
                "T. Chen",
                "X. Luo",
                "Q. Wen"
            ],
            "title": "A survey on the security of blockchain systems",
            "venue": "Future Generat. Comput. Syst.,",
            "year": 2017
        },
        {
            "authors": [
                "K. Liao",
                "Z. Zhao",
                "A. Doup\u00e9",
                "Ahn",
                "G.-J"
            ],
            "title": "Behind closed doors: measurement and analysis of cryptolocker ransoms in bitcoin",
            "venue": "Electronic Crime Research (ECrime),",
            "year": 2016
        },
        {
            "authors": [
                "J.K. Liu",
                "V.K. Wei",
                "D.S. Wong"
            ],
            "title": "Linkable spontaneous anonymous group signature for ad hoc groups",
            "venue": "In: ACISP,",
            "year": 2004
        },
        {
            "authors": [
                "G. Maxwell"
            ],
            "title": "Coinswap: Transaction Graph Disjoint Trustless Trading",
            "venue": "CoinSwap: Transactiongraphdisjointtrustlesstrading (October",
            "year": 2013
        },
        {
            "authors": [
                "G. Maxwell"
            ],
            "title": "Coinjoin: bitcoin privacy for the real world",
            "venue": "Post on Bitcoin Forum",
            "year": 2013
        },
        {
            "authors": [
                "S. Meiklejohn",
                "C. Orlandi"
            ],
            "title": "Privacy-enhancing Overlays in Bitcoin",
            "year": 2015
        },
        {
            "authors": [
                "S. Meiklejohn",
                "M. Pomarole",
                "G. Jordan",
                "K. Levchenko",
                "D. McCoy",
                "G.M. Voelker",
                "S. Savage"
            ],
            "title": "A fistful of bitcoins: characterizing payments among men with no names",
            "venue": "Proceedings of the 2013 Conference on Internet Measurement Conference",
            "year": 2013
        },
        {
            "authors": [
                "I. Miers",
                "C. Garman",
                "M. Green",
                "A.D. Rubin"
            ],
            "title": "Zerocoin: anonymous distributed",
            "year": 2013
        },
        {
            "authors": [
                "P Paillier"
            ],
            "title": "Public-key cryptosystems based on composite degree residuosity",
            "year": 1999
        },
        {
            "authors": [
                "Pedersen",
                "T.P"
            ],
            "title": "Non-interactive and information-theoretic secure verifiable",
            "venue": "classes. In: Eurocrypt,",
            "year": 1991
        },
        {
            "authors": [
                "B. Qin",
                "J. Huang",
                "Q. Wang",
                "X. Luo",
                "B. Liang",
                "W. Shi"
            ],
            "title": "Cecoin: a decentralized",
            "venue": "handbook on digital transformations,",
            "year": 2017
        },
        {
            "authors": [
                "M. Harrigan"
            ],
            "title": "An analysis of anonymity in the bitcoin system",
            "year": 2013
        },
        {
            "authors": [
                "R. Rivest",
                "A. Shamir",
                "Y. Tauman"
            ],
            "title": "How to leak a secret",
            "venue": "Social Networks. Springer,",
            "year": 2001
        },
        {
            "authors": [
                "D. Ron",
                "A. Shamir"
            ],
            "title": "Quantitative analysis of the full bitcoin transaction graph",
            "venue": "CryptologyASIACRYPT",
            "year": 2001
        },
        {
            "authors": [
                "T. pp. 6\u201324. Ruffing",
                "P. Moreno-Sanchez",
                "A. Kate"
            ],
            "title": "Coinshuffle: practical decentralized coin",
            "year": 2014
        },
        {
            "authors": [
                "Sun",
                "S.-F",
                "M.H. Au",
                "J.K. Liu",
                "T.H. Yuen"
            ],
            "title": "Ringct 2.0: a compact",
            "venue": "Security. Springer,",
            "year": 2017
        },
        {
            "authors": [
                "M. 456\u2013474. Swan"
            ],
            "title": "Blockchain: Blueprint for a New Economy",
            "venue": "O\u2019Reilly Media, Inc. Szabo, N.,",
            "year": 2015
        },
        {
            "authors": [
                "D. Tapscott",
                "A. Tapscott"
            ],
            "title": "Hemorheol. and Microcirc",
            "year": 2016
        },
        {
            "authors": [
                "L. Valenta",
                "B. Rowan"
            ],
            "title": "Bitcoin Is Changing Money, Business, and the World",
            "venue": "Penguin. Tor project. https://www.torproject.org/. Underwood, S.,",
            "year": 2016
        },
        {
            "authors": [
                "N. pp. 112\u2013126. van Saberhagen"
            ],
            "title": "Challenges and opportunities associated with a bitcoin-based",
            "venue": "Cryptonote V",
            "year": 2013
        },
        {
            "authors": [
                "B. Qin",
                "J. Hu",
                "F. Xiao"
            ],
            "title": "Preserving transaction privacy in bitcoin",
            "year": 2017
        },
        {
            "authors": [
                "Wuhan University",
                "Wuhan",
                "China. Her research interests include cryptographic protocols. Debiao He received his Ph.D. degree in applied mathematics from School of Mathematics",
                "Statistics",
                "Wuhan University in"
            ],
            "title": "He is currently a professor of the Key Laboratory of Aerospace Information Security and Trusted Computing, Ministry of Education, School of Cyber Science and Engineering, Wuhan University",
            "venue": "His main research interests",
            "year": 2009
        },
        {
            "authors": [
                "India in"
            ],
            "title": "He is currently an Associate Professor in the Department of Computer Science and Engineering, Thapar University, Patiala, India",
            "venue": "He has guidedmany students leading to M.E. and Ph.D. He has more than 200 technical research papers in leading journals such as IEEE TRANSACTIONS ON INDUSTRIAL INFORMATICS, IEEE TRANSACTIONS ON INDUSTRIAL ELECTRONICS, IEEE TRANSACTIONS ON DEPENDABLE AND",
            "year": 2009
        }
    ],
    "sections": [
        {
            "text": "Journal of Network and Computer Applications 126 (2019) 45\u201358\nContents lists available at ScienceDirect\nJournal of Network and Computer Applications\njournal homepage: www.elsevier.com/locate/jnca\nReview\nA survey on privacy protection in blockchain system\nQi Feng a, Debiao He a,\u2217, Sherali Zeadally b, Muhammad Khurram Khan c, Neeraj Kumar d\na Key Laboratory of Aerospace Information Security and Trusted Computing, Ministry of Education, School of Cyber Science and Engineering, Wuhan University, Wuhan, China b College of Communication and Information at the University of Kentucky, USA c Center of Excellence in Information Assurance (CoEIA), King Saud University, Saudi Arabia d Department of Computer Science and Engineering, Thapar University, Patiala, India\nA R T I C L E I N F O\nKeywords: Privacy Anonymity Blockchain Cryptography Cryptocurrency\nA B S T R A C T\nBlockchain, as a decentralized and distributed public ledger technology in peer-to-peer network, has received considerable attention recently. It applies a linked block structure to verify and store data, and applies the trusted consensus mechanism to synchronize changes in data, which makes it possible to create a tamper-proof digital platform for storing and sharing data. It is believed that blockchain can be utilized in diverse Internet interactive systems (e.g., Internet of Things, supply chain systems, identity management, and so on). However, there are some privacy challenges that may hinder the applications of blockchain. The goal of this survey is to provide some insights into the privacy issues associated with blockchain. We analyze the privacy threats in blockchain and discuss existing cryptographic defense mechanisms, i.e., anonymity and transaction privacy preservation. Furthermore, we summarize some typical implementations of privacy preservation mechanisms in blockchain and explore future research challenges that still need to be addressed in order to preserve privacy when blockchain is used."
        },
        {
            "heading": "1. Introduction",
            "text": "Marking the new dawn of a new era, blockchain is a groundbreaking innovation in decentralized information technology. Originally invented as the underlying infrastructure of (Bitcoin) (the first decentralized cryptocurrency which develops extremely rapidly since its release in 2009), blockchain\u2019s potential application has reached far beyond cryptocurrency and financial assets. As the technology gained wider recognition in recent years, there has been a flurry of advancements, new use cases and applications. The range of potential applications of blockchain is endless, from cryptocurrencies to Internet of thing (IoT), supply chain management (SCM) and so on.\nIn the area of digital currency, blockchain constitutes the basic underlying infrastructure, which allows the monetary operation to be performed in a distributed way without the need of some central entities. Built upon blockchain, (Bitcoin) and other altcoins such as (Ethereum project, Litecoin, Monero project and Zerocash), have grown into a new surprisingly robust ecosystem. According to the statistics (BitInfoCharts, 2017), The market capitalization (as of July 2018) of\n\u2217 Corresponding author. E-mail addresses: fq.whu@whu.edn.cn (Q. Feng), hedebiao@163.com (D. He), szeadally@uky.edu (S. Zeadally), mkhurram@ksu.edu.sa (M.K. Khan),\nnehra04@yahoo.co.in (N. Kumar).\nBitcoin is over $112 billions and Ethereum is over $47 billions. Not less than 60 thousands blockchain transactions per hour can be confirmed all over the world.\nAlthough cryptocurrency is the most paradigmatic application of blockchain, there are other applications far beyond it, e.g., blockchain makes it attractive for the Internet of Things (IoT) environment which is equipped with a decentralized topology and many Internet-enabled devices. By using blockchain, device management could be automated and data synchronization could be easier and faster among IoT devices (as discussed in (Huh et al., 2017; Dorri et al., 2016; Conoscenti et al., 2016)). Moreover, blockchain can also enhance the transparency and traceability of ownership for the supply chain management system (as discussed in (Kim and Laskowski, 2016; Korpela et al., 2017; Abeyratne and Monfared, 2016)). Furthermore, the decentralized feature of blockchain can inherently ease the pressure on centralized servers, such as in public key infrastructure or identity management system (as discussed in (Ali et al., 2016; Fromknecht et al., 2014; Ebrahimi, 2017; Qin et al., 2017)).\nhttps://doi.org/10.1016/j.jnca.2018.10.020 Received 1 May 2018; Received in revised form 17 September 2018; Accepted 29 October 2018 Available online 13 November 2018 1084-8045/\u00a9 2018 Elsevier Ltd. All rights reserved.\nAlthough blockchain can provide a powerful abstraction for the design of distributed systems, privacy issues (e.g., the leakage of user real identity and transaction amount) should not be ignored from the protection of users\u2019 interests. For example, when the blockchain is integrated into supply chain management (SCM) system, if the buyersupplier relations during the blockchain communication or the extra information for each communication are not protected, it may leak trade secrets of the suppliers. For example, the price of products from different suppliers can be estimated by analyzing transaction records. As a result, the suppliers\u2019 incentives to apply this blockchain-based system will be diminished for their interests are compromised, which seriously limits the widely applications of blockchain in SCM system. From the above indications, it is necessary to conduct a systematic summary and evaluation on the privacy preservation of blockchain."
        },
        {
            "heading": "1.1. Our contributions",
            "text": "As far as we know, most of the review articles (Li et al., 2017; Zheng et al., 2016; Halim et al., 2017; Bonneau et al., 2015) are emphasizing the comprehensive overview on the security issues and challenges of blockchain. Other surveys are focusing on the privacy challenges on the decentralized cryptocurrencies (Genkin et al., 2018; Meiklejohn and Orlandi, 2015; Ylihuumo et al., 2016).\nThe first objectives of our surveys is to give a critical comparative analysis of cryptographic defense mechanisms for the privacy of blockchain. Originality of the survey is multifold: 1) redefines the concept of privacy in blockchain, not just the user\u2019s privacy, but also the transaction-related privacy, 2) introduces existing threats on the presented two concepts of privacy in blockchain, 3) introduces several technologies, especially cryptographic techniques, which have be used to protect privacy of blockchain, 4) presents a step-by-step analysis in order to help the readers to better understand the origin, objective, and drawback of each protection approach, 5) compares the impact of various privacy preserving methods in current practical projects, and finally, 6) identities future research directions on privacy protection for blockchain.\nFurthermore, the present survey brings several attractive advantages. First, it leads the users and researchers to understand the management challenges and opportunities in the privacy of blockchain. Second, it helps a security designer to specify, validate and implement adaptive privacy preservation policies in blockchain applications. Finally, this survey conveys to the reader the ability to conduct science investigation mission to analyze privacy attacks against blockchain."
        },
        {
            "heading": "1.2. Paper organization",
            "text": "We organize the remainder of this paper as follows. Section 2 presents an overview on the basic architecture and characteristics of blockchain. Section 3 provides a detailed analysis of the privacy requirements and existing threats. We discuss different techniques for identity privacy preservation in Section 4. Section 5 classifies and compares cryptographic protocols that are used for transaction privacy of blockchain. Furthermore, we summarize these techniques and discuss future research directions that need to be explored further to mitigate privacy concerns of blockchain in Section 6. Finally, Section 7 concludes this paper."
        },
        {
            "heading": "2. Overview of blockchain",
            "text": "Blockchain was originally introduced by S. Nakamoto (2008) to record all the transactions of Bitcoin and avoid misbehaving or cheating. To better understand the core concept and technology of blockchain, we will overview some knowledge about blockchain in this section, i.e., the fundamental structure of blockchain, how many types of blockchain there are, as well as what the main characteristics of blockchain are."
        },
        {
            "heading": "2.1. Structure of blockchain",
            "text": "Basically, blockchain is an append-only database maintained by the nodes of a peer-to-peer (P2P) network. As shown in Fig. 1, the basic structure of the blockchain may consist of three levels, i.e., underlying P2P network, databases and its various applications.\nThe P2P network is responsible to ensure the freely communication among the blockchain nodes, where the nodes are geographically dispersed but being equally privileged participants in the application. There is no centralized server in P2P network, and each nodes is an information consumer, but also an information provider. Each node engages in the routing process of the entire network, the discovering and maintaining of connections to neighboring peers, the propagation and verification of transactions, as well as the synchronization of data blocks (transaction and block are both the data structure of blockchain, which will be introduced in the subsequent content). This \u201cflat\u201d topology of P2P network is the key reflection and basis of the blockchain\u2019s decentralized feature.\nThe global ledger is responsible for the core mission of blockchain, i.e., transmitting message reliably and trustfully between account addresses. The account address is an unique digital pseudonym when users engaging in the blockchain, which is normally generated with the public key cryptography (e.g., elliptic curve cryptography) by the user. Each communication between two or more addresses are carried out through a transaction, which is indeed a record including senders\u2019 addresses, receivers\u2019 addresses, messages, and of course, signatures from related participants and so on. There is a special and flexible message exchanging mode in blockchain, i.e., smart contract. There are various definitions about it, for example: in Bitcoin, it is an script executing during the confirmation of cryptocurrency; in Ethereum, it is extended to be a Turing-complete language and can achieve more complex functions; in (Hyperledger projects), it directly executes the blockchain functions. All of the related messages will be eventually recorded in blockchain global ledger.\nWhen confirming a transaction or smart contract, the global ledger will record it in a continuously growing list of blocks, where each block carries a hash pointer as a link to the previous one, a timestamp and some transactions or smart contracts organized in the form of a Merkle Hash Tree. These blocks are linked together from the genesis block to the latest block in the chronological order, which is why blockchain be named. Note that the genesis block is the Block #0 of the blockchain and has no previous block. Every transaction and block will eventually be broadcast through the entire P2P network, and an agreed-on consensus mechanism (e.g., proof of work (POW) (Nakamoto, 2008), proof of stake (POS) (Siim), practical byzantine fault tolerance (PBFT) (Castro Liskovet al., 1999) and etc) will be carried out to determine what blocks get added to the ledger and what the current state is. Finally, this global ledger will then be synchronized among the peers of blockchain and therefore, cannot be modified easily by malicious entities.\nThe applications of blockchain provides application program interfaces (APIs) for various scenarios. Users directly interact with each other via these APIs with no need to think about details of underlying technologies. As introduced in Section 1, the most widely application of blockchain is still in financial fields. Furthermore, the project of Hyperlegder incubates and promotes a range of blockchain businesses, including distributed ledger frameworks, smart contract engines, client libraries, graphical interfaces and so on. Based on the immutability and integrity of blockchain, some other applications such as digital document management platform (Factom), copyright protection system (Binded), distributed data network (Maidsafe), autonomous decentralized P2P telemetry ADEPT for IoT (Cohn et al., 2017) and so on have been released for different scenarios."
        },
        {
            "heading": "2.2. Classification of blockchain",
            "text": "Based on the permissioning, there are three options of blockchain: i.e., public blockchain, private blockchain and consortium blockchain. Most projects today rely on the public blockchain, which grants access to a large number of users, network nodes, and markets. However, there are still reasons to prefer a private blockchain or consortium blockchain (among a group of trusted participants). For example, a number of companies in verticals, like banking, are looking to private blockchain as their own data exchanging platform. Here, we explains the difference between these three style:\n\u2022 Public blockchain: a public blockchain (e.g., Bitcoin or Ethereum) is a blockchain that any participant can read, submit transactions to and expect to see them included if they are valid, as well as engage in the consensus process. As a substitute for centralized or quasicentralized trust, public blockchain are secure by cryptoeconomics (the merge of economic incentives and cryptographic verification), where following a general principle that the degree to which someone can have an influence in the consensus process is proportional to the quantity of economic resources that they can bring to bear. A public blockchain is, therefore, a completely transparent and decentralized database of the transactions on an open network. \u2022 Consortium blockchain: a consortium blockchain (e.g., the HyperLedger) is a blockchain where the consensus process is controlled by a pre-selected set of nodes. For example, one might imagine a consortium of 15 institutions each of which operates a node and of which 10 must confirm a block in order for the block to be valid. The right to read the blockchain may be public, or restricted to specific participants. There are also hybrid routes such as providing an\npublic API that allows members to make a limited number of queries and get back the root hashes of blocks along with the cryptographic proofs on the blockchain states. A consortium blockchain is, therefore, considered to be partially decentralized. \u2022 Private blockchain: a private blockchain is, essentially, the inverse of public blockchain in all key attributes, where the write permission is kept centralized to one organization in a fully private blockchain and the read permissions may be public or restricted with an arbitrary extent. Ultimately, private blockchain is a catch-all term for anything that is not completely public. There is broad flexibility for governance and management within it."
        },
        {
            "heading": "2.3. Key characteristics of blockchain",
            "text": "Here, we will conclude from several research efforts (e.g., (Nakamoto, 2008; Swan, 2015; Pilkington, 2016; Underwood, 2016; Tapscott and Tapscott, 2016)) four attributes which describe a basic blockchain architecture as a general decentralized ledger offering data integrity and traceability. We describe these characteristics next.\n1. Autonomous: One significant property of blockchain is that there is no single entity controlling or governing the network. In particular, in a public setting, any node can sign and publish transactions to the blockchain and reviews them at any time if they are accepted by other nodes of the decentralized network. Besides, everyone could join in the consensus process so as to expand new blocks into the blockchain. 2. Distributed: Blockchain system is built on the P2P network, where every signed transaction will be broadcast by the source node to its one-hop peers. Then, the neighboring peers verify these incoming\ntransactions: valid ones will be relayed further and invalid ones will be discarded. Eventually, these transactions can spread across the entire P2P network. A newly generated block will be treated in the same way in terms of its notification and synchronization in the network. 3. Immutability: All the valid blocks and transactions recorded on the global ledger are practically immutable due to the need for verification by other nodes and traceability of changes. Furthermore, the whole global ledger will be synchronized among the blockchain nodes following the consensus mechanism, such that users are provided with a higher degree of confidence that the data in blockchain is unaltered and accurate. 4. Contractual: The consensus process (e.g., mining or voting) depends on the status of the data. Consensus is achieved by executing the rules (i.e., smart contract) of the blockchain without any central authorization. These code-defined rules ensure that any monetary actions will be executed timely and correctly without human intervention.\nThese characteristics bring several benefits that are derived from the blockchain architecture (e.g., durability, transparency, verifiability, and process integrity (Abeyratne and Monfared, 2016))."
        },
        {
            "heading": "3. Privacy requirements and threats for blockchain",
            "text": "Next, we present two analyses that extract the privacy requirements and threats which arise from the network environment, transactions, and applications. The first analysis is based on the fundamental characteristics of blockchain, and the second analysis describes the various threats in detail."
        },
        {
            "heading": "3.1. Privacy requirements for blockchain",
            "text": "To protect privacy, the blockchain needs to satisfy the following requirements: (1) the links between transactions should not be visible or discoverable, and (2) the content of transactions is only known to their partakers. As we mentioned earlier, the private or permissioned blockchain could set an access control policy to satisfy the privacy requirements of blockchain, which means the complete transparency of the blockchain data is not a problem. However, in the case of a public setting, everyone can have access to the blockchain with no restrictions, the privacy requirements should be considered on the following two factors:\n1. Identity Privacy: which means intractability between the transaction scripts and the real identities of their partakers, as well as the transactional relationships between users. Even if users apply random addresses (or pseudonyms) when acting in the blockchain, they can only provide limited identity privacy. By monitoring the unencrypted network and traversal through the public blockchain, some behavioral analysis strategies (e.g., anti-money laundering (AML) regulation (Schott, 2006) or know your customer (KYC) policy (Gill and Taylor, 2004)) may reveal some information about who is using blockchain, or for what. 2. Transaction Privacy: which means that the transaction contents (e.g., amount or transacting patterns) can only be accessed by specified users, and kept unknown to the public blockchain network. Transaction privacy is desired in many blockchain-based applications, e.g., electrical health record management or big data\u2019s anonymous authentication and authorization, where users may wish for increased levels of privacy and avoid revealing their sensitive information to any curious blockchain entities."
        },
        {
            "heading": "3.2. Privacy threats for blockchain",
            "text": "As described previously, a transaction of blockchain contains the addresses of its participants, trade values, timestamp and signature of\nits sender. Due to the public nature of the blockchain network, it is possible to trace the flow of transactions to extract the users\u2019 physical identities or other additional information by data mining. In this section, we refer to the Bitcoin (Nakamoto, 2008) system as a typical instance to analyze the privacy threats for the blockchain network."
        },
        {
            "heading": "3.2.1. De-anonymization",
            "text": "Bitcoin provides a limited form of unlinkability: users always create pseudonyms when they connect to the bitcoin system. However, due to the public and openness of blockchain, it is possible to perform a static analysis of the blockchain or actively listening for network information to unmask users, i.e., de-anonymization. Here, we list several attacks that may work for de-anonymizing users\u2019 real identities.\n1. Network Analysis: as we mentioned in Section 2, the blockchain is based on the P2P network architecture which means that a node will leak its IP address when broadcasting transactions. Koshy et al. (2014) identified three anomalous relay patterns for network analysis which could be used to map bitcoin addresses to IP addresses (i.e., multi-relayer & non-rerelayed transaction, single-relayer transactions and multi-relayer & rerelayed transactions). Reid and Harrigan (2013) conducted network analysis via publicly available information from the bitcoin faucets which give out a small amount of bitcoin freely. These sites sometimes publish the IP addresses of recipients to prevent abuse. 2. Address Clustering: there are inherent properties of the transaction in blockchain could be applied to link addresses controlled by the same user: (a) According to the structure of blockchain (Nakamoto, 2008), all\nthe inputs in a transaction are normally signed by the sender, therefore the addresses of inputs involved in one transaction may be controlled by the same entity (user or organization). (b) The change address (Bitcoinwiki) is the one that receives the price difference between the outputs and the actual value the user intends to pay. Thus in a transaction, the change address and input addresses always point to the same party. The change address is normally created by the wallet and will unlikely to be re-used for accepting payments, e.g., in bitcoin. (c) Some transactions does not contain an origin-destination pair. For example, coinbase blocks (Wiki. coinbase) have no origin address (i.e., no inputs) and points to one destination address (i.e., one output). This is indeed the origin of a transaction list and the only destination address always points to a miner or a mining pool. (d) To speed up the confirmation process of a transaction, the approaches presented in (Vornberger, 2012; Vandervort, 2014) add some typical markers aiming to leverage existing trust relationships (e.g., identification information or certificates). Based on these knowledge and other side information, the users could partition the network into different clusters of addresses. After being tagged via data collection technology, some of the addresses can be discovered to be corresponded to the same user. These approaches may not be easy in practice but still cannot be ignored. Researches in (Reid and Harrigan, 2013; Liao et al., 2016; Spagnuolo et al., 2014) has utilized this knowledge as heuristics for address clustering.\n3. Transaction Fingerprinting: Another threat to anonymity is a transaction\u2019s user-related features. Androulaki et al. (2013) summarized six attributes that may characterize some aspects of transaction behaviors, i.e., Random time-interval (RTI), hour of day (HOD), time of hour (TOH), time of day (TOD), coin flow (CF) and input/output balance (IOB). Extra consideration on these attributes may increase the probability to de-anonymize an individual user. Androulaki et al. (2013) conducted an experiment in an university, where students uses Bitcoin as the daily transaction currency. By utilizing cluster\nanalysis based on the transaction fingerprints, the researches finally could recover the profiles of approximately 40% of the users, even when users adopt a new address for every transaction. 4. DoS Attacks: a denial-of-service attack is a cyber attack where the malicious attacker seeks to make a machine or network resource unavailable to its clients by disrupting services of the host connected to the Internet. One of the hiding approaches for IP addresses in P2P network is using anonymity networks (e.g., TOR), however, Biryukov et al. (Biryukov and Pustogarov, 2015) pointed out that the DoS attack may disconnect a TOR node from the blockchain network. 5. Sybil Attacks: a Sybil attack is a cyber attack where the malicious attacker subverts the reputation system of a P2P network by creating a large number of pseudonymous identities, using them to gain a disadvantageous influence. As for the de-anonymization in the blockchain, Bissias et al. (2014) analyzed that Sybil attacks could break or block the decentralized anonymity protocols and will increase the possibility to find out the users\u2019 real identities."
        },
        {
            "heading": "3.2.2. Transaction pattern exposure",
            "text": "Except for some personally identifiable information, other transaction information flows to the public network can be used to extract statistical distributions, which may reveal some new regulation within the applications of blockchain.\n1. Transaction graph analysis: This type of analysis focuses on discovering some overall transaction features (e.g., daily turnover, exchange rate or transaction pattern) over time. For example, in bitcoin, Ron and Shamir (2013) identified all the largest transactions in the transaction graph and found out four characteristic transaction patterns in the bitcoin network. These features may have the chance of discovering someone\u2019s financial history when used in conjunction with de-anonymization methods (see Section 3.2). 2. AS-level deployment analysis: This technique aims to crawl the bitcoin network by recursively connecting to clients, requesting and collecting their lists of other peer\u2019s IP addresses. In this way, one can obtain concrete information on size, structure and distribution of the bitcoin\u2019s core network. These parameters can be used to impact at least the vitality and resilience of bitcoin\u2019s ecosystem. For example, Feld et al. (2014) analyzed the size and distribution of the bitcoin system among autonomous systems (AS) and found out that more than 30% of all nodes belong to 10 AS while over 900 AS contain just one single node."
        },
        {
            "heading": "4. Methodology for identity privacy preservation",
            "text": "This section presents a comprehensive overview of solutions that have been recently proposed by researchers aimed at preserving privacy of the blockchain. In a public setting such as in the cryptocurrency (Decred) or the blockchain-based electric vehicle charging system (Knirsch et al., 2018), it is suggested that the users\u2019 addresses needed to be changed by generating a new key pair for each session. Except that, there are three frequently-used mechanisms for protecting anonymity in the blockchain and they include: mixing services, ring signature, and non-interactive zero-knowledge proof."
        },
        {
            "heading": "4.1. Mixing services",
            "text": "In the blockchain, it is linkable between senders and receivers of a transaction, therefore, by analyzing the public content (i.e., analytical attack), one can infer some privacy information. One of the solutions to mitigate this attack is to obfuscate the transaction\u2019s relationships with the help of mixer (aka tumbler or laundry). A mixing service, first presented by Chaum (1981), allows users to hide who a participant communicates with as well as the content of the communication. We present the concepts in (Chaum, 1981) below (with the basic\narchitecture shown in Fig. 2): Assume that one entity prepares a message M for delivery to another entity at address R. What he/she need to do is encrypting M with the receiver\u2019s public key KR, appending the address R, and then encrypting the result with the intermediary\u2019s public key KI . The left-hand of the following expression denotes the ciphertext, which is transferred to an intermediary:\nKI(r0,KR(r1,M),R) \u2192 KR(r1,M),R\nThe symbol \u2192 denotes the transformation of the ciphertext by the intermediary into another ciphertext shown on the right-hand side. This transformation performs a decryption on the original ciphertext by the intermediary with its private key. Then the intermediary delivers the sub-ciphertext to R who then decrypts it with his/her own private key. It is to note that r1 and r0 are random numbers which ensure that no message is transferred more than once.\nWhen the intermediary gets many inputs and outputs, this mechanism will hide the correspondences between each message\u2019s origin and destination. The order of arrival is hidden by outputting the uniformly sized items in random patterns. Additionally, to minimize the danger of the single intermediary being the attacker, multiple intermediaries can be linked together thereby creating a mix cascade.\nOver the last few years, these services have been integrated into the blockchain network to obfuscate the transaction history and reduce the risk of de-anonymization. The research efforts mainly focus on two aspects: (i) centralized mixing and (ii) decentralized mixing."
        },
        {
            "heading": "4.1.1. Centralized mixing services",
            "text": "There are multiple mixing websites available (Onionbc; Bitcoin fog; Bitmixer; Helix by grams; Bitlaundry; Send shared; Bitblender). All of them offer the functionality to mix transactions anonymously at the cost of some service fees. These websites act as online mixers and swap the transactions among different users in order to hide the relationship between their incoming and outgoing transactions. In addition, most of them are reachable only via the TOR network (Tor project) which enables anonymous communications through a free, worldwide, volunteer overlay network.\nThere are two disadvantages behind these sites: (1) A possible attacker could be the service provider who would steal users\u2019 assets by not transferring them to the receivers analyzed by (Meiklejohn et al., 2013); (2) The service providers are in the middle and therefore they always keep logs for a certain time in order to route the transactions through the system whilst users cannot ensure that their personal data is not be disclosed.\nTo solve the first problem, one of the solutions is conditional execution, which means that if and only if the mixer operates correctly, it can get reward, otherwise it gets nothing. For example, Gregory Maxwell introduced a third party-based mixing protocol for the bitcoin system called CoinSwap (Maxwell, 2013a). The general flow of this protocol is\nthat many senders deliver transactions to many receivers with a mixer acting as the intermediary. All the transactions between the sender & mixer and the mixer & receiver are escrow transactions that are protected by hash-lock and can only be spent by corresponding redeeming transactions. This lock mechanism ensures that no one can steal the user\u2019s assets. However, the transactions are sent in plaintext, the mixer can still track all the transaction pairs and all the transactions\u2019 information between them.\nAnother attempt to address the first problem is to audit the misbehaved mixer which means using undeniable evidence for supervising the mixer\u2019s activities. For example, Mixcoin, proposed by Bonneau et al. (2014), adds a signature-based accountability mechanism to expose theft so that users are able to unambiguously prove if the mixer has misbehaved. Malicious operations will quickly have the mixer\u2019s reputation destroyed. Like CoinSwap, there is no way to prove that the mixer is not storing records sufficient to de-anonymize its users.\nFor the second question, the blind signature scheme is a common and advantageous tool for preserving privacy at the mixer side. A blind signature is such a digital signature wherein the message is blinded before it is signed. This approach generally consists of three procedures, i.e., blinding (covering the original message together with a random \u201cblinding factor\u201d), signing (signing the blinded message following the standard sign algorithm) and unblinding (removing the \u201cblinding factor\u201d to get a valid signature on the actual message). The resulting signature can be publicly verified while the signer will never know the connection between the message and the one he/she signed. Thus this can be used in protocols where anonymity is required. For example, Blindcoin (Valenta and Rowan, 2015), introduced by Valenta et al., combines the blind signature scheme with an append-only public log to keep the mixing process accountable and provides evidence against misbehaved mixer. Heilman et al. (2016) applies blind signature and smart contract to ensure anonymity and fairness during the mixing process.\nOne of the first attempts to provide anonymity in practical digital currency was Dash (released in 2014) (Dash is digital cash). In this project, a coin-mixing service called PrivateSend is created to remove all the unique information about the users from the blockchain network. The mixing network consists of a set of specific nodes (called master nodes) instead of a single website and restricts the mixing process to only accept certain denominations. Furthermore, every master node must pay 1000 Dash (the cryptocoin in Dash network) as a deposit that can increase the cost with master nodes\u2019 violations. However, the process of mixing is limited by the number of online participants (i.e., just three parties per round in Dash private transaction).\nTumbleBit (Heilman et al., 2017) is the first approach to simultaneously achieve full unlinkability and avoids coin theft. The method is based on a centralized service but utilizes secure two-party computation and zero-knowledge proof in order to protect the user\u2019s privacy and the fairness of the transaction (includes enforcement on the mixing server to execute the protocol honestly). The mixing is done in three main steps: firstly, the payee engages the Tumbler (i.e., mixer in TumbleBit protocol) in the \u201cPuzzle-Promise Protocol\u201d and the later will set up an escrow transaction with one crypto-coin and return a puzzle (RSA encrypted version of the escrow cash-out transaction) to the payee. Secondly, the receiver gives the blinded puzzle to the payer who will then pay the Tumbler one crypto-coin to decrypt the puzzle, here they utilize the cut-and-choose protocol to enhance honest behavior among payer, payee and Tumbler. Finally, after the payer returns the blinded answer to the payee, the later will unblinds it and broadcasts the transaction. However, researchers in (Kuan and Chen, 2017) pointed out that there are several issue need to be noticed: 1) the hash-locks take up a lot of transaction space, which will lead to extra blockchain storage, network bandwidth and transaction fee, 2) it cannot support multiple payments in one single transaction, furthermore, 3) the multi-round cutand-choose protocol takes a heavy execution time, which cannot satisfy real-time application requirements.\nIn conclusion, the centralized mixing services mainly suffer from three limitations: (i) the delay incurred when waiting for enough online participants to be mixed or executing the interactive process for fairness exchange is quite high; (ii) the centralized mixing server still remains a single point of failure, which may be vulnerable to denial of service (DOS) attacks and it also becomes the bottleneck of the distributed blockchain network; (iii) users always need to pay a fairly high mixing fees or deposits in practice."
        },
        {
            "heading": "4.1.2. Decentralized mixing services",
            "text": "To mitigate the DOS threat caused by the centralized services, a decentralized mixing pattern is proposed to enable a set of mutually untrusted peers to publish their messages simultaneously and anonymously without the need of a third-party anonymity proxy. Another major benefit of this approach is the elimination of the need for mixing fees. Furthermore, it is closer and more compatible to the decentralized structure of blockchain compared to the centralized mixing pattern. So far, there are mainly two methods to achieve the decentralized mixing process, i.e., CoinJoin and multi-party computation (MPC).\nCoinJoin (Maxwell, 2013b) is a special transaction first described in the Bitcoin Forum by Gregory Maxwell. The core idea of CoinJoin is \u201cWhen you want to make a payment, find some one else who also wants to make a payment and make a joint payment together.\u201c. For example, as illustrated in Fig. 3, there are two transactions: one is from User  to User  and another is from User  to User . These two independent transactions can be combined together into one CoinJoin transaction while inputs and outputs are unchanged. The resulting joint transaction mixes the link between inputs and outputs so that the exact direction of data flow will be kept unknown to the other peers.\nThis method provides perfect compatibility with Bitcoin-like blockchain, while ensuring that even malicious nodes can get nothing about transaction relationships. An alpha version of this sort of mixing technology has been implemented in Dark Wallet (Greenberg, 2014), (Joinmarket - coinjoin tha, 2015), and so on. However, CoinJoin suffers from three significantly drawbacks:\n1. It lacks internal unlinkability which means that participants will know the details about the joint transaction, including the destinations of the transactions with which the senders\u2019 addresses are paired. This increases the likelihood of a Sybil attack as the number of available participants increases. 2. It is susceptible to the Denial-of-Service (DoS) attack proven in (Bissias et al., 2014). Assume that an attacker can create enough separate virtual entities which are associated with unique IP addresses and blockchain addresses. This attack may block the mixing process by refusing to sign the CoinJoin transactions. 3. A practical issue with CoinJoin is that the number of participants n has a maximum. One of the reasons for this maximum is because of the increased vulnerability to DoS attacks, and another reason is the exponential increasing communication overhead. On the other hand, when n is small, the effect of anonymity and unlinkability will be lower.\nTo achieve the internal unlinkability, CoinShuffle, proposed by Ruffing et al. (2014), utilizes an anonymous group communication protocol to hide the participants\u2019 identities from each other. This method achieves the internal unlinkanility by the simple trick of layered encryption, and the cost of high communication and computation overhead. Bissias et al. (2014) proposed a totally different approach, i.e., XIM, to support large anonymity sets. This protocol is based on the fairexchange mixer in (Barber et al., 2012) as a secure method for partnering mix users without leaving evidence. Moreover, XIM mitigates the effects of Sybil attacks by an additional participating fee. However, it requires a significant waiting time in the whole mixing time, typical be in the order of hours.\nMPC (also known as secure multi-party computation) is a cryptographic method that ensures input privacy and jointly correct computation. In MPC, given a number of participants P1,P2,\u2026 ,PN with each of them having private data d1, d2,\u2026 , dN , respectively. Participants compute the value of a public function on the private data: F(d1, d2,\u2026 , dN) while keeping their own inputs private. After the computation, all that the parties can learn is what they can learn from the output and their own input. The main operation of this method is playing over distance without requiring a trusted party which is suitable for decentralized tasks. Thus, (Ziegeldorf et al., 2015) proposed an ECDSA-based threshold scheme to achieve MPC and introduced the CoinParty protocol wherein users are allowed to generate a escrow address using multiple private keys and a threshold transaction is required to redeem its funds, i.e., only when a majority of participants agree to do so.\nTable 1, which is largely based on a similar comparison from (Genkin et al., 2018), concludes and compares the main mixing services in blockchain in terms of five aspects as follows:\n1. Whether the protocol can fully hide the identities of users. 2. Whether there is a centralized party involved in the mixing process. 3. Any fee for mixing services. 4. The risk of being blocked by Sybil attack. 5. Whether there is any possibility of coin-theft. 6. The number of participants per mixing round. 7. The delay incurred waiting to be mixed.\nIn short, mixing services are relatively simple methods for privacy protection in blockchain. Most of them are compatible with existing blockchain networks without any particular consensus mechanism, which means they need less resources to be implemented. Furthermore, combined with a proper defensive technique, mixing services can provide an acceptable privacy protection."
        },
        {
            "heading": "4.2. Ring signature",
            "text": "Although the decentralized mixing techniques (Maxwell, 2013b; Ruffing et al., 2014; Bissias et al., 2014; Ziegeldorf et al., 2015) offer \u201cspontaneous\u201d mixing in the blockchain, they still require a delay while participants discover their partners for their transactions to be mixed. The ring signature enables a user (also a member of a set) to sign a message on behalf of the \u201cring\u201d of members but no way to tell which is the real one who signed. The core idea of this technology is the choice of a set without any central manager, which will significantly improve pri-\nvacy in blockchain. In this section, we first present the basic idea behind the ring signature. Then, we present two existing ring implementations that achieve anonymity in blockchain."
        },
        {
            "heading": "4.2.1. Ring signature",
            "text": "Ring signature was initially designed by Rivest et al. in (Rivest et al., 2001) as a digital signature that could be used to produce a valid but anonymous signature from a group of possible signers without telling which member actually produced the signature (as illustrated in Fig. 4).\nAs shown in Fig. 4, in a ring architecture, User  chooses a set of participants including himself/herself and creates a ring {User0,User1,\u2026 ,Usern}. Each participant has a public key from a standard signature scheme (e.g., RSA, ECDSA). User  signs a message with his/her private key (SKs) and all the public keys (PK0, \u00b7 \u00b7 \u00b7, PKs, \u00b7 \u00b7 \u00b7, PKn) of the members in the ring. The verifier can tell that one of the set has signed the message but does not know who is the actual signer. Therefore, this signature provides complete anonymity for the signer.\nOne of the modified versions of ring signatures is the traceable ring signature (Fujisaki and Suzuki, 2007; Fujisaki, 2011). This type of ring signature can detect if two signatures were produced by the same user. Each traceable ring signature has a tag T = (issue,PK), where PK denotes the public keys of the members (e.g., PK0 \u00b7 \u00b7 \u00b7PKn in the Fig. 4) of the set and issue is a label of a specific election or survey. In this case,  signs his/her message with SKs and T. The verifier also checks the resulting signature with tag T instead of just PK. There are two interesting statements on this signature:\n1. If  signed one message twice using the same T, the two signatures can be linked by a public procedure while the identity of  remains concealed (i.e., linkability). 2. If  signed two different messages using the same T, then the two messages are from the same signer, and the anonymity of  will be revealed (i.e., traceability).\nIt is worth noting that any two signatures produced by two distinct tags are always unlinkable."
        },
        {
            "heading": "4.2.2. CryptoNote & Monero",
            "text": "The properties of anonymity and linkability have led to the development of several ring-based privacy preservation protocols for blockchain (e.g., (van Saberhagen, 2013; Noether Mackenzieet al., 2016; Sun et al., 2017)).\nTa bl\ne 1\nSu m\nm ar\ny of\nm ix\nin g\nse rv\nic es\nin bl\noc kc\nha in\n.\nPr ot\noc ol\nA no\nny m\nity Ce\nnt ra\nliz ed\npa rt\ny M\nix co\nst D\nos re\nsi st\nan ce\nSy bi\nlr es\nis ta\nnc e\nTh ef\ntr es\nis ta\nnc e\nM ix\nin g\nsc al\ne W\nai tin\ng de\nla y\nM ix\nin g\nw eb\nsi te\n(O ni\non bc\n) \u223c\n(B itb\nle nd\ner )\nLi nk\nab le\nat m\nix er\nN ee\nde d\nYe s\nLo w\nH ig\nh H\nig h\nLi m\nite d\nto ac\nce ss\nH ig h Co in Sw ap (M ax w el l, 20 13 a) Li nk ab le at m ix er N ee de d Ye s Lo w H ig h Pr ot ec te d N o lim ita tio n H ig h M ix co in (B on ne au et al ., 20 14 ) Li nk ab le at m ix er N ee de d Ye s Lo w H ig h A cc ou nt ab le N o lim ita tio n H ig h Bl in dc oi n (V al en ta an d Ro w an ,2 01 5) U nl in ka bl e N ee de d Ye s Lo w H ig h A cc ou nt ab le N o lim ita tio n hi gh Bl in dl y Si gn ed Co nt ra ct s (V al en ta an d Ro w an ,2 01 5) U nl in ka bl e N ee de d Ye s Lo w H ig h Pr ot ec te d N o lim ita tio n H ig h Tu m bl eB it (H ei lm an et al ., 20 17 ) U nl in ka bl e N ee de d Ye s H ig h H ig h Pr ot ec te d Li m ite d by tr an sa ct io n sp ac e H ig h D as h (D as h is di gi ta lc as h) U nl in ka bl e N ee de d, m ul tip le Ye s H ig h, m ul tipl e m ix er s H ig h Pr ev en te d w ith de po si t Sm al l, up to th re e M\nid dl\ne\nCo in\nJo in\n(M ax\nw el\nl, 20\n13 b)\nIn te\nrn al\nU nl\nin ka\nbl e\nD ec\nen tr\nal iz\ned N\no Lo\nw Lo\nw H\nig h\nSm al\nl, sa\nm e\ntr an\nsa ct\nio n\nva lu\ne H\nig h\nCo in\nSh uffl\ne (R\nuffi ng\net al\n., 20\n14 )\nU nl\nin ka\nbl e\nD ec\nen tr\nal iz\ned N\no M\nid dl\ne, bl\nam e\nH ig\nh H\nig h\nSm al\nl, sa\nm e\ntr an\nsa ct\nio n\nva lu\ne H\nig h\nXI M\n(B is\nsi as\net al\n., 20\n14 )\nU nl\nin ka\nbl e\nD ec\nen tr\nal iz\ned N\no M\nid dl\ne w\nith fe\nes M\nid dl\ne w\nith fe\nes Lo\nw La\nrg e\nH ig h Co in Pa rt y (Z ie ge ld or fe ta l., 20 15 ) U nl in ka bl e D ec en tr al iz ed N o H ig h H ig h, M PC N ee d 2/ 3 ho ne st La rg e H ig h\nFig. 4. Ring signature anonymity.\nSaberhagen (van Saberhagen, 2013) implemented a slight modification of the traceable ring signature which allows a user to sign only one valid transaction with one private key. In his solution (called CryptoNote), the tag is replaced with a key image computed from the user\u2019s one-time private key to mitigate the double-spending attack. The identity of the signer is indistinguishable from the other users whose public keys are in the set until the owner produces a second signature using the same key pairs (see Fig. 5).\nAt the receiver\u2019s end, CryptoNote uses a one-time key pair for each asset transformation even for the same sender and receiver. Fig. 6 illustrates the basic idea of this technology. The destination of each CryptoNote output is a public key derived from receiver\u2019s one-time address and sender\u2019s random data. This ensures that every destination address is unique (unless the sender uses the same data for each of his/her transaction to the same receiver).\nA standard transaction sequence is as follows: before sending a transaction, the sender  calculates a new destination address based on the public key of the receiver . The matching one-time keys can by recovered only by using the private key of . To transfer this transaction again, the output is signed with the one-time ring signatures by one-time keys, the key image and the anonymous public key set. In this sense, an incoming transaction for the same receiver is sent to a onetime address (instead of a unique address) and only the real receiver can spend the funds involved in this transaction. Furthermore, the traceable ring signature ensures unlinkable payments while precents doublespending when signing the transaction.\nThe CryptoNote protocol is vulnerable to analysis attacks based on the transaction amount. Another security drawback is that it requires\nFig. 5. Ring signature anonymity in CyrptoNote.\na specific set of public keys having the same amount involved in a ring signature which will lead to a smaller anonymity set than may be desired. These security weaknesses are discussed in depth in (Noether Mackenzieet al., 2016).\nAn improvement of the CryptoNote is Ring Confidential Transaction (RingCT) proposed by (Noether Mackenzieet al., 2016). The key innovation of this approach is hiding the amount using Greg Maxwell\u2019s Confidential Transaction (Maxwell, 2015) and the ring signature on the hidden amount is placed in the bottom row of the multilayered linkable spontaneous anonymous group signature (MLSAG) (Liu et al., 2004). Their solution can provide identity privacy and transaction privacy simultaneously. The most successful implementation of this approach to date is the cryptocurrency named Monero (Monero project) (first released in 2014).\nAlthough the ring signature provides strong anonymity, it suffers from three limitations:\n1. The size of its transactions (especially RingCT transactions) are very large, almost thousands of bytes per transaction. It will increase the storage space for the entire blockchain records. 2. The inherent drawback of ring signature is that a signature\u2019s size is directly proportional to the number of participants. Thus in practice, there are only a limited number of foreign outputs in each transaction (e.g., 4 outputs per Monero transaction by default). 3. The hidden amount will make it difficult for auditing, i.e., to verify if new cryptocurrencies have been generated secretly during the transaction or to determine the extra amount at some point."
        },
        {
            "heading": "4.3. Non-interactive zero-knowledge proof",
            "text": "Zero-knowledge proof (ZKP) is a cryptographic method with the goal to prove a given statement without leaking any additional information. Non-interactive zero-knowledge proof (NIZK) is a variant of ZKP where the interaction between the prover and the verifier is missing which is suitable in blockchain to verify the message anonymously and in a distributed way. Therefore, in this section, we present a general overview of the NIZK cryptography and two examples of its usage in preserving privacy of blockchain."
        },
        {
            "heading": "4.3.1. Non-interactive zero-knowledge proof",
            "text": "The concept of NIZK proof was proposed by (Blum et al., 1988). The ability to prove the correctness of an assertion independently without leaking additional information makes NIZK proof well suitable for creating privacy preserving protocols.\nA formal definition of the NIZK proof system is: Let a pair of probabilistic polynomial time algorithms (P, V) be the prover and verifier, respectively. For language  \u2286 NP (with a security parameter \ud835\udf05), (P, V) is called the NIZK proof system for language  if it meets the following properties.\n1. Completeness: for any input x \u2208 , its witness w and polynomial p(\u00b7),\nPr[V(R, x,P(R, x,w)) = 1] \u2265 1 \u2212 1 p(|x|)\n2. Soundness: for any input x \u2209 , any probabilistic polynomial time algorithms P\u2217 and polynomial p(\u00b7),\nPr[V(R, x,P\u2217(R, x)) = 1] < 1 p(|x|)\n3. Zero knowledge: for any x \u2208  and its witness w, there is a probabilistic polynomial time simulator S such that the two distributions are computationally indistinguishable:\n{R, x,P(R, x,w)} \u2248 {R, x, \ud835\udf0b} \u2190 S(x)\nwhich means that all the information obtained by the verifier during the interaction with the proofer can also be computed by a probabilistic polynomial time simulator.\nIt is worth noting that R is a public random reference string."
        },
        {
            "heading": "4.3.2. Zerocoin & zerocash",
            "text": "Owing to the properties of completeness, soundness and zero knowledge, Zerocoin (Miers et al., 2013) employs NIZK proof cryptography to prevent transaction graph analysis. The main ideas behind this projects is analogous to decentralized mixing, where a coin is minted first and later redeemed with a totally new one that has no history information. NIZK proof cryptography is used to authenticate the validity of the minted coin so that an equal-priced new coin will be paid back.\nIn Zerocoin, all the valid coins with fixed denomination are maintained in the public ledger (i.e., the blockchain). A transaction with some amounts in Zerocoin consists of three steps, i.e., mint \u2192 publish \u2192 redeem. For example, if User  will pay a coin to User ,  first needs to mint a coin by computing a random serial number sn and committing it with a trapdoor r. The resulting commitment cm can only be opened by (sn, r) while neither of them can be obtained by cm. Then  publishes cm with a mint transaction, which will be later verified and recorded in the public ledger through the consensus algorithms. When  wants to redeem this coin, he/she needs to send a spend transaction which contains the serial number sn and a NIZK proof \ud835\udf0b for the statements as follows:\n1. He/She knows a commitment cm in the public ledger. 2. He/She knows the secret trapdoor r with which cm opens to sn.\nIf cm is correct and sn has not been spent previously, a new coin will be redeemed back; otherwise the transaction will be rejected and discarded. In this scenario, \u2019s minted coin cannot be linked to \u2019s retrieved funds because the proof \ud835\udf0b is zero-knowledge: there is no information about the exact mint transaction corresponding to the spend\ntransaction; r is unknowable from the sn revealed. Therefore, the origin of the transaction is anonymous.\nAlthough Zerocoin provides strong anonymity guarantee, there are three main limitations that need to be considered:\n1. Since  knows the sn, he/she may redeem it before  does so, or if  transferred this coin to ,  will find out when  redeems with sn. 2. The fixed denomination of coins may be a major obstacle in its deployment in future applications. 3. Its public transaction lists cannot protect transaction privacy in terms of the amount or other metadata.\nZerocash (Sasson et al., 2014) made an improvement by providing identity and transaction privacy simultaneously to address some of the above limitations and achieved a high level of privacy protection for blockchain. A more detailed description of Zerocash is given in Section 5.1.\nIn addition to the mentioned methodologies, i.e., mixing, ring signature and NIZK, there are also some other mechanisms such as cryptographic commitment that can be used to protect user\u2019s sensitive information. Normally, a commitment is such a cryptographic primitives including \u201ccommit\u201d and \u201creveal\u201d phases, where values will be hidden by committing on it, and revealed later by the legal user. A general commitment scheme satisfies \u201cbinding\u201d that the committed values are unaltered to any one including the one who commits on it. The research of Delmolino et al. (2016) utilized commitment scheme to protect the inputs of participants instead of being in plaintext, where the observers learns nothing about the other input choice even after revealing commitment. Similarly to (Delmolino et al., 2016), Knirsch et al. (2017) combined commitment and embedding mechanism to ensure that the embedded information remain completely private even after the revealing commitment. Furthermore, they also utilize the mixing approach to shuffling the relationships between ends of communication."
        },
        {
            "heading": "5. Methodology for transaction privacy preservation",
            "text": "This section discusses all the critical elements among the existing protocols that support transaction privacy in the blockchain. There are two main approaches for preserving transaction privacy of the blockchain, i.e., NIZK proof and homomorphic cryptosystem."
        },
        {
            "heading": "5.1. Non-interactive zero-knowledge proof",
            "text": "The basic idea behind the NIZK proof is described in Section 4.3. However, due to the fixed denomination (as we discussed before), Zerocoin provides strong anonymity but is unable to protect transaction privacy.\nTherefore, Session et al. (Sasson et al., 2014) presented and issued a new cryptocurrency Zerocash aiming to achieve anonymity and transaction privacy simultaneously. In contrast to Zerocoin, Zerocash addresses the aforementioned issues via following technologies.\n1. Zerocash makes use of zero-knowledge succinct non-interactive arguments of knowledge (zk-SNARKs) proof and a commitment scheme to hide a payment\u2019s original address. Furthermore, the coin value is added in the commitment and zero-knowledge proof so that the value is arbitrary and publicly verifiable. 2. Zerocash modifies the deviation of a coin commitment and serial number for each target payment. When the coins are spent, totally fresh serial numbers sn will be issued using the receiver\u2019s new private key. This mechanism ensures that even if the sender knows the previous sn, he/she still be unable to track or re-spend the coins. 3. The sender encrypts the transaction amounts and other metadata using the receiver\u2019s public key before spending the coins, and appends the ciphertext in the spending transaction. This type of transaction does not leak paid amounts and destination addresses\nbecause of the security of public-key encryption scheme.\nZerocash achieves the highest level of anonymity and transaction privacy protection for the blockchain but at the expense of high computational costs it requires when it generates the transaction proofs.\nIn contrast, as other technology such as smart contract has emerged where users can arbitrarily define programs running in the blockchain, it is important to consider the programmability aspect without exposing transactions and data in cleartext to the public (i.e., any party not involved in the contract). Hawk presented by Kosba et al. (2016) is the first work to simultaneously provide transactional privacy and programmability in the blockchain. This method is based on the idea of Zerocash and the smart contract system, users send encrypted and committed information to the smart contract, and rely on the NIZK proofs to enforce the correctness of contract execution and funds\u2019 transfer. While the result of smart contract can be publicly verifiable, the entire sequence of transaction actions taken in the contract are kept confidential from the public.\nA more in-depth discussion of smart contract system is out of scope of the survey, but is presented in (Szabo, 1997; Wood, 2014)."
        },
        {
            "heading": "5.2. Homomorphic cryptosystem",
            "text": "A homomorphic cryptosystem (HC) is such a cryptographic encryption methodology that satisfies homomorphism so as to preserve arithmetic operations carried out on ciphertexts. It allows any party to perform computation on the ciphertexts while preserving the privacy of digital data.\nConsider the following scenario,  has secret values {x1, x2,\u2026 , xn} and  has a function f(\u00b7).  and  wants to calculate f(x1,\u2026 , xn) together without leaking secret values or algorithm details. We define E(\u00b7)\u2215D(\u00b7) to be a set of the homomorphic encryption system. Then  can send encrypted inputs {E(x1),\u2026 ,E(xn)} to  who later performs the normal computations on the ciphertexts, randomizes and outputs the result to . After decryption,  will learn f(x1,\u2026 , xn) securely.\nIn general, homomorphic cryptography performs as black box, when given n ciphertexts and operations, it outputs the encrypted result of the same operations on the corresponding original data. This attractive feature makes homomorphic cryptography well suited for hiding and performing timely update of the amount and other medatata of a transaction. Typical homomorphic cryptographic schemes which could be used to protect privacy of blockchain include the Pedersen commitment scheme (Pedersenet al., 1991) and Paillier cryptosystem (Paillieret al., 1999)."
        },
        {
            "heading": "5.2.1. Pedersen commitment scheme",
            "text": "The Pedersen commitment scheme (Pedersenet al., 1991) is one of the implementations of the homomorphic commitment scheme. It supports homomorphic operations (i.e., addition or multiplication) on the commitments and can provide perfect hiding of real message with the same trapdoor.\nThe Confidential Transaction (CT), conceptualized by Gregory Maxwell (Maxwell, 2015), was first implemented with the range proof scheme to protect the transaction privacy of the blockchain. In CT, the transaction amounts are committed by random blinding factors before sent to the recipients and later notarized by the recipients. As a result of the homomorphism property of Pederson commitment scheme, all the encrypted inputs and outputs of a transaction can be added up, respectively. The two encrypted sums are then compared to ensure trade-off when verifying the transaction. This process does not reveal the real amounts or other metadata of the transaction.\nRingCT (described in Section 4.2.2) is a variant of CT used in Monero. In order to support the ring signature that provides sender\u2019s anonymity, RingCT verifies the transaction by added all the commitments on inputs and outputs up to a commitment on zero. Furthermore, users sign for the commitment when publishing transaction in original\nCT scheme, whereas in the RingCT scheme users just need to prove that he/she has the corresponding secret key of the commitment."
        },
        {
            "heading": "5.2.2. Paillier cryptosystem",
            "text": "The Paillier cryptosystem (Paillieret al., 1999) is an efficient additive homomorphic encryption system that is based on the composite residuosity class problem. This means that given only the ciphertexts on m1 and m2 along with the same public key, anyone can calculate the ciphertext on m1 + m2. This method works very well for privacy preservation for financial scenarios where the transactions are mainly related to addition or subtraction operations on the amount or balance.\nTherefore, considering the transaction privacy problem for blockchain, Wang et al. (2017) designed a framework where the Paillier cryptosystem is used to hide the real amount of each transaction, and Commitment Proof is used for checking the validity of the encrypted amount (i.e., ensures that the amount is positive and verifies the tradeoff between inputs and outputs). These encrypted transactions are like sealed asset envelopes which can be merged, separated, or used while keeping the amount invisible. However, this method cannot support auditing requirement when using in some fields that need to be regulated and/or supervise."
        },
        {
            "heading": "6. Discussion and future research directions",
            "text": "In this section, we summarize and discuss the methodologies described above. We focus our comparison on the their impact on privacy protection, main disadvantages and their existing implementations. Finally, we discuss some future research directions in the area of privacy preservation of blockchain."
        },
        {
            "heading": "6.1. Summary and discussion",
            "text": "Table 2 summarizes the privacy-preserving methodologies in Section 4 and Section 5 in terms of their security goal, main disadvantages and their practical implementations.\nAs described above, centralized mixing and decentralized mixing aim to protect the relationship between the sender address and the receiver address with a mixing service. The difference is that the former needs a centralized mixer to do this task while the latter accomplishes the mixing jointly among the participants. However, there are some common disadvantages including: additional delay for waiting to be mixed and no protection for the transaction\u2019s content (due to the fixed denomination requirement in a mixing session), and some unique limitations such as the centralized mixer will charge for mixing services and may also be vulnerable in terms of being a single point failure, or in the decentralized one, some participants may destroy the mixing process by rejecting to execute the protocols. Furthermore, the frequency of communications between participants in decentralized mixing will cause high transmission overheads on the network channel, which may limit the scalability of a mixing session.\nThe ring signature is a typical anonymous signature which can be used to hide the signer\u2019s identity. However, as a signature scheme, it does not purposely hide the message to be signed. Furthermore, another limitation for this scheme is the size of signature is proportional to the number of participants, which means the more participants, the more storage and communication costs. Thus, when applied to blockchain, CryptoNote utilizes ring signature, one-time payment and confidential transaction together to protect the sender\u2019s (i.e., the signer\u2019s) privacy, the receiver\u2019s privacy as well as the transaction\u2019s content, respectively. Furthermore, in order to keep the size of the transaction within a reasonable range, only a limited number of participants are allowed to engage in the signing stage which may reduce the difficulty of data mining on senders\u2019 addresses.\nNIZK cooperates with the commitment scheme to provide a comprehensive privacy protection structure for the blockchain such as Zcash.\nNIZK proof proves the ownership of the coins with an anonymous and unlinkable way. The commitment scheme can hide the transaction content with non-repudiation and non-modifiability. Thus, with these two technologies, Zcash can provide strong anonymity for the users and the highest preservation on transaction content simultaneously without any bound on the size of anonymity set per transaction. However, the NIZK protocol incurs high computation overheads specially in the proof generation phase of zk-SNARKs protocol used in Zcash.\nThe homomorphic cryptosystem (HC) is a valuable methodology to protect the contents of a transaction, even while computing on the protected data. The Confidential Transaction (CT), used in Bitcoin and Monero, is indeed an homomorphic commitment. The Paillier encryption, an additive homomorphic cryptographic technique, has attracted a lot of interest in the academic world but unfortunately it has not be implemented in practical projects. It may need some time to be applied to blockchain implementations.\nAs summarized as above, we note that there have been many efforts for protecting privacy in blockchain. These efforts focused mainly on the following aspects:\n- Obfuscation on the transaction relationships to resist linking or tracing analysis. - Hiding the identities of the sender and the receiver via complicated cryptographic primitives. - Blinding the transaction content whilst retaining the verifiability and computability."
        },
        {
            "heading": "6.2. Future research directions",
            "text": "From a practical perspective, blockchain can consider all the cryptocurrencies (such as Bitcoin, Ethereum) and open source platforms (such as HyperLedger) as a huge incubator, from which it can adapt to different requirements of a range of application areas. However, privacy preservation approaches that have been developed to date are still far from meeting the requirements of some important applications. Hence, we present a few research directions that need further investigation in the future.\n1. Scalable and economy: As shown in Table 2, both centralized and decentralized mixing methodologies incur an additional waiting delay. The complex cryptographic primitives (e.g., NIZK or MPC used in decentralized mixing methodologies) normally bring about heavy computation and communication overheads. For example, the average running time for proof generation in Zcash is approximately 2 min. Furthermore, we can see that the size of an anonymous transaction signature in CryptoNote is proportional to the number of participants, which means that as the number of participants increases, the storage and communication costs also increase. These high costs limit the scalability of an anonymity set. Therefore, one possible direction is to solve the combinatorial optimization problem among the existing or novel cryptographic primitives and their possible configurations. 2. Stronger privacy under weaker assumptions: Another challenge for the methodologies presented above is achieving strong privacy preservation under milder assumptions. For example, the zk-SNARKs protocol used in ZCash inherently requires a trusted third party for setup and initialization of the system; a certain percentage of the participants in decentralized mixing protocols are assumed to be honest so as to resist or mitigate the Sybil attack; the homomorphic cryptosystem assumes that the executives, who use the encrypted or committed data for further computing or verifying, is semi-honest, i.e., they are curious about the contents under the cipher texts but will follow the protocol honestly; for every different smart contract, the Hawk will re-initialized a separate trusted setup process to generate it. From an optimization perspective, one of the potential research directions is to enhance the privacy preservation but without or with only a few trust assumptions.\n3. Compatibility: There are several transaction structures that exist for different application scenarios and requirements, e.g., Bitcoin\u2019s Unspent Transaction Outputs (UTXO) architecture and the Ethereum\u2019s ACCOUNT architecture. More details are presented in (Nakamoto, 2008; Wood, 2014). Basically, the former is the vital component of cryptocurrency that will be linked by a chain of digital signatures, which is the mostly used structure implemented for the transactions protected by the above methodologies. Although the latter works in a similar way as in the traditional banking world, i.e., addresses\u2019 accounts are maintained as a global state and the transactions just independently affect the state these accounts. Unfortunately, none of the existing schemes consider privacy preservation under this transaction structure. Due to its programmable system, Ethereum is considered to be an ideal platform for decentralized applications and is therefore valuable but is a challenge for the privacy preservation methodologies to be compatible with the ACCOUNT architecture. 4. Legal traceability and accountability: Privacy protection in the blockchain is a \u201cdouble-edge sword\u201d. On one hand, a well-behaved user would like to maintain his/her identity and action privately. On the other hand, a malicious entity may abuse the privacy protection mechanism for some illegal transaction. Therefore, privacy preservation in blockchain may need to be conditional such that a trusted authority (e.g., Public Security Bureau or Court) can find a way to track a targeted user and collect all the messages he/she has disseminated, while the user\u2019s sensitive information is still protected from the public."
        },
        {
            "heading": "7. Conclusion",
            "text": "Recently, blockchain has received considerable attention in decentralized information systems because of its decentralized nature and security feature. It provides a completely different way for storing, sharing and updating data and will play a crucial role in future Internet interactive system (e.g., Internet of Things or supply chain systems). However, the growing need for privacy protections may be a hindrance to emerging blockchain\u2019s real applications.\nIn this context, this survey reviews the existing privacy issues associated with the blockchain network. Then, we present a comprehensive analysis of cryptographic protection mechanisms in terms of both anonymity and transaction privacy. Based on the review and discussions for these mechanisms that achieve privacy protection in the blockchain, we identity future research directions for blockchain\u2019s privacy protection."
        },
        {
            "heading": "Acknowledgments",
            "text": "The work was supported in part by the National Key Research and Development Program of China under Grant 2017YFB0802500, in part by the National Natural Science Foundation of China under Grant 61501333, Grant 61572379, Grant 61472287, and Grant 61772377, and in part by the Natural Science Foundation of Hubei Province of China under Grant 2017CFA007 and Grant 2015CFA068. We thank the anonymous reviewers for the valuable comments and suggestions which helped us improve the content, organization, and presentation of this paper."
        }
    ],
    "title": "A survey on privacy protection in blockchain system",
    "year": 2018
}